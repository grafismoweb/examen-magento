<?php

/**
 * @var \Hiberus\Rodriguez\Block\Index $block
 */
$alumnos = $block->getAlumno();
$notas = $block->getAverageMarks();
$notaMinima = $block->getNota();
$i = 0;
$elementos = $block->getElementos();
$maxMarks = $block->getMaxMarks();
?>

<h2 class="title">Alumnos</h2>

<!-- Ejercicio 7 js -->
<button id="desplegar">Desplegar</button>
<!-- Ejercicio 9 js -->
<button id="notaMasAlta">nota mas alta</button>


<div id="details"><!-- div toggle btn -->

    <?php

    foreach ($alumnos as $alumno) {
        // Para que salga rojo suspensos y verdes aprobados
        if ($i++ == $elementos) break;
        if ($alumno->getMark() > $notaMinima) { // 4.9
            $classEvaluation = "approved";
        } else {
            $classEvaluation = "suspensed";
        }
        ?>

        <ul>
            <li>Nombre:<?= $alumno->getFirstName(); ?></li>
            <li>Apellido: <?= $alumno->getLastName(); ?></li>
            <li class="<?= $classEvaluation ?>">Nota:<?= $alumno->getMark(); ?></li>
        </ul>

    <?php } ?>

</div> <!-- div toggle btn -->

<p>Notas mas altas:<p/>
<?php foreach($maxMarks as $mark) { ?>
    <p><?= $mark ?></p>
<?php } ?>

<p> Media de notas: <?= $notas ?> </p>
<p> Total de alumnos: <?= (count($alumnos)) ?> </p>

<script>
    var maxNote = <?= $block->getMaxMark() ?>
</script>


<script>
    require(['jquery', 'toggle'], function ($, myscript) {
        myscript('#desplegar', '#details');
    });
    require(['jquery', 'alert'], function($, alertNotaAlta) {
        alertNotaAlta('#notaMasAlta');
    });
</script>

